
/*

Thoughts on backstory:

Rick and Brian are meeting at a coffee shop as an informal hangout meeting.
The two of them have been friends for a long time, dating back to high school.
They've been through a lot together, and have remained friends, but their
friendship has occasionally been strained.

Rick is gay, Brian is straight. Brian has been in and out of relationships in
the past few months, and is attempting to balance a desire for sensation and
release with a deeper sense that he's missing something. Also is concerned that
he is getting older (both are in late 20s) and he should be finding some
direction in his life. Brian has been working random jobs and rarely holding
anything down.

Rick has been more stable, but is struggling with his own anxieties and desires.
Rick has the opposite problem, where he feels like his life is too stable, and
he is interested in more adventure. Rick is in a relationship with another
character, Sam, who is himself frustrated with Rick's stability and has been
having flings with other guys. Rick knows this, but is pretending that it hasn't
been happening.

Rick is waiting at the coffee shop, Brian is late again, as usual.

player agent should be Brian, I think.......
Gives a choice as to whether to be apologetic or what.
*/

conversation CoffeeShop;

participants rick, brian;

/*

Implementation notes:
beat {} blocks normally allow a choice between the nodes inside.

at a root level of a beat, it's possible to break out of the beat,
it is possible to break in a block otherwise only if an out is specified
a topic may only be broken out of if a topic break is specified.

for the first beat in a topic, only starting beats are allowed. Correspondingly,
only starting nodes are allowed when starting a new beat.

about below: seems like coffee and waiting should be separate topics entirely

node grouping types:
default/op (optional)
  this allows a choice between any of the available nodes or node groups.

seq (sequential)
  these nodes must occur in a sequence

any
  it is possible to choose amongst these freely.

The PC will be given a choice among options, but an AI driven NPC will probably
choose randomly if there are several available possibilities.

I think that nodes and beats will be one shot- that is, once it's been used, it
is done and can't be selected again.

Some conditions are momentary-- ie, they are only enabled after a certain beat
or node is just called. This is used with the just_bought_coffee stuff below

*/


starting topic {
    welcome

    starting beat {
        seq {
            starting node {rick, "Hey there"}
            node {rick, just_bought_coffee "I bought you a latte, but it's a bit cold now."}
            initiate subject: waiting
        }
        op {
            beat break,
            seq{node {brian, just_sullen, no response "...", sullen++}, topic break}
        }
    }

    beat {
        enabled on subject: waiting
        seq {
            starting node {brian, sorry, "yeah, sorry about that", apologetic++}
            node {rick, "no worries"}
            op{beat break, topic break}
        }
        seq {
            starting node {brian, "how long were you waiting?"}
            node {rick, "oh not too long."}
            node {rick, "just a minute or two."}
            op {sorry, beat break, topic break}
        }
    }

    beat {
        enabled on subject: waiting
        initiate subject: coffee

        seq {
            starting node {brian, "so anyway,", enabled on !just_bought_coffee}
            what_kind_of_latte // <-- initiates this node 
        }

        seq {
            starting node {brian, what_kind_of_latte, "what kind of latte did you get me?" initiate subject: coffee}
            node {rick, "it's one of their seasonal specials. It sounded extremely noxious and sweet, I thought you would love it."}
            op {
                node {brian, "*sip* mmm, delicious", cheerful++}
                node {brian, "you know me so well!", congenial++}
                op {beat break, topic break}
            }
        }

        seq {
            starting node {brian, "aww, you shouldn't have!" initiate subject: coffee, enabled on: just_bought_coffee, cheerful++}
            op {what_kind_of_latte, beat break, topic break}
        }
    }
}



topic {
    obscure inquiries

    beat {
        seq {
            node {rick, "so... how are you?"}
            op{
                node {brian, "not too bad"} // generic non-answer
                node {brian, "pretty good, actually", cheerful++, positivity++}
                node {brian, ""}
            }
        }
    }
    beat {
        seq {
            node {rick, "been up to anything exciting?"}

        }
    }
}



